<?xml version='1.0' encoding='UTF-8'?>
<templates id='template' xml:space='preserve'>
    <t t-name="echarts_bar_template">
        <div id="main" style="width:100%; height:100%;">
            <div id="ech" class="row">
            </div>
        </div>
        <script>
            $(function () {
                fetchData();
            });
            function fetchData() {
                $.ajax({
                    type: "GET",
                    url: "/pyecharts",
                    dataType: 'json',
                    success: function (result) {
                        console.log('success');
                        console.log(result);
                        var count = result.count;
                        var column = result.column;
                        var col = "col-md-" + String(12 / column);
                        var details = result.details;
                        var ech = document.getElementById("ech");
                        for (var detail in details) {
                            console.log(details[detail]);
                            var detailDiv = document.createElement("div");
                            detailDiv.setAttribute("class", col);
                            var d = document.createElement("div");
                            d.setAttribute("id", details[detail]['sequence']);
                            d.style.width = "100%";
                            d.style.height = "400px";
                            detailDiv.appendChild(d);

                            ech.appendChild(detailDiv);

                            var chart = echarts.init(document.getElementById(details[detail]['sequence']), 'white', {renderer: 'canvas'});
                            chart.setOption(details[detail]['edata']);
                        }
                    },
                    error: function(request) {
                        console.log("error")
                    },
                });
            }
        </script>
    </t>
</templates>
